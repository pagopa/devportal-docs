# Flusso di Rendicontazione

Per consentire agli EC la riconciliazione dei riversamenti avvenuti (rif. [riconciliazione-del-flusso-di-riversamento.md](riconciliazione-del-flusso-di-riversamento.md "mention")), il PSP che ha effettuato l’operazione provvede ad inviare al Nodo dei Pagamenti-SPC un flusso di rendicontazione (FdR) predisposto secondo lo schema riportato nella Tabella 6.&#x20;

Tale flusso deve essere inviato entro, e non oltre, le ore 24 della seconda giornata lavorativa successiva alla ricezione dell’ordine di pagamento (D+2).

Le colonne _Liv_, _Gen_, _Occ_ e _Len_ della citata Tabella 6 assumono il seguente significato:

#### Tabella 5 - **Flusso per la rendicontazione -** Descrizione colonne

<table><thead><tr><th width="155.1992874973217">colonna</th><th width="572.9414632585621">descrizione</th></tr></thead><tbody><tr><td><em>Liv</em></td><td>indica il livello di indentazione del dato al fine di rendere evidenti le strutture che contengono ulteriori informazioni (colonna "Gen" uguale ad <em>s</em>): esempio, le strutture di livello 1 sono formate da tutti i dati di livello superiore ad 1, quelle di livello 2 sono formate da tutti i dati di livello superiore a 2, e così via.</td></tr><tr><td><em>Gen</em></td><td><p>indica il genere (tipo) del dato da utilizzare; può assumere i seguenti valori:</p><ul><li>s - struttura che può contenere altre strutture o dati,</li><li>an - dato alfanumerico</li><li>n - dato numerico.</li></ul></td></tr><tr><td><em>Occ</em></td><td>indica le “occorrenze” del dato nel formato <strong>min..max.</strong></td></tr><tr><td><em>Len</em></td><td>indica la lunghezza massima del dato nel formato <strong>min..max;</strong> nel caso si tratti di una lunghezza fissa comparirà solo il dato <em>len</em>, nel caso di lunghezze fisse in alternativa la notazione sarà <em>len1 / len2.</em></td></tr></tbody></table>

**Tabella 6 -  Flusso per la rendicontazione - Schema dati**

<table><thead><tr><th width="206">Dato</th><th width="150">Liv</th><th width="150">Gen</th><th width="150">Occ</th><th width="181">Len</th><th>Contenuto</th></tr></thead><tbody><tr><td>versioneOggetto</td><td>1</td><td>an</td><td>1..1</td><td>1..16</td><td><p>Versione che identifica l’oggetto scambiato.</p><p>Valori ammessi: <strong>“1.0” e “1.1”</strong></p></td></tr><tr><td>identificativoFlusso</td><td>1</td><td>an</td><td>1..1</td><td>1..35</td><td><p>Identificativo legato alla generazione e trasmissione del flusso di riversamento.</p><p>Deve essere univoco nell’ambito dell’anno di riferimento delle operazioni di pagamento cui si riferisce il flusso.</p></td></tr><tr><td>dataOraFlusso</td><td>1</td><td>an</td><td>1..1</td><td>19</td><td><p>Indica la data e ora di creazione del flusso, secondo il formato ISO 8601</p><p><strong>[YYYY]-[MM]-[DD]T[hh]:[mm]:[ss]</strong></p></td></tr><tr><td>identificativoUnivocoRegolamento</td><td>1</td><td>an</td><td>1..1</td><td>1..35</td><td>Riferimento assegnato dal PSP all’operazione di trasferimento fondi con la quale viene regolato contabilmente il riversamento delle somme incassate ovvero l’accumulo degli accrediti disposti dai clienti.</td></tr><tr><td>dataRegolamento</td><td>3</td><td>an</td><td>o</td><td>10</td><td>Indica la data di esecuzione dell’operazione di trasferimento fondi con la quale viene regolato contabilmente il riversamento delle somme incassate, nel formato ISO 8601 [YYYY]-[MM]-[DD].</td></tr><tr><td>istitutoMittente</td><td>1</td><td>s</td><td>1..1</td><td> </td><td>Aggregazione relativa al PSP mittente che genera il presente flusso.</td></tr><tr><td>identificativoUnivocoMittente</td><td>2</td><td>s</td><td>1..1</td><td> </td><td>Aggregazione che riporta le informazioni concernenti l’identificazione dell’Istituto mittente del flusso.</td></tr><tr><td>tipoIdentificativoUnivoco</td><td>3</td><td>an</td><td>1..1</td><td>1</td><td><p>Campo alfanumerico che descrive la codifica utilizzata per individuare l’Istituto Mittente; se presente può assumere i seguenti valori:</p><ul><li><strong>‘G’</strong> = persona giuridica</li><li><strong>‘A’</strong> = Codice ABI</li><li><strong>‘B’</strong> = Codice BIC (standard ISO 9362)</li></ul></td></tr><tr><td>codiceIdentificativoUnivoco</td><td>3</td><td>an</td><td>1..1</td><td>1..35</td><td>Campo alfanumerico che può contenere il codice fiscale o la partita IVA, il codice ABI o il codice BIC del PSP mittente, in funzione del dato tipoIdentificativoUnivoco.</td></tr><tr><td>denominazioneMittente</td><td>2</td><td>an</td><td>0..1</td><td>1..70</td><td>Contiene la denominazione del PSP mittente che genera il flusso.</td></tr><tr><td>codiceBicBancaDiRiversamento</td><td>2</td><td>an</td><td>0..1</td><td>1..35</td><td>Contiene il codice BIC del PSP che ha generato il SEPA Credit Transfer di riversamento. Corrisponde al dato AT-09 del SCT.</td></tr><tr><td>istitutoRicevente</td><td>1</td><td>s</td><td>1..1</td><td> </td><td>Aggregazione relativa all’EC destinatario del flusso.</td></tr><tr><td>identificativoUnivocoRicevente</td><td>2</td><td>s</td><td>1..1</td><td> </td><td>Aggregazione che riporta le informazioni concernenti l’identificazione fiscale dell’EC che riceve il flusso.</td></tr><tr><td>tipoIdentificativoUnivoco</td><td>3</td><td>an</td><td>1..1</td><td>1</td><td>Campo alfanumerico che indica la natura dell’EC; se presente deve assumere il valore <strong>‘G’</strong>, Identificativo fiscale Persona Giuridica.</td></tr><tr><td>codiceIdentificativoUnivoco</td><td>3</td><td>an</td><td>1..1</td><td>1..35</td><td>Campo alfanumerico contenente il codice fiscale dell’EC destinatario del flusso.</td></tr><tr><td>denominazioneRicevente</td><td>2</td><td>an</td><td>0..1</td><td>1..70</td><td>Contiene la denominazione dell’EC che riceve il flusso.</td></tr><tr><td>numeroTotalePagamenti</td><td>1</td><td>n</td><td>1..1</td><td>1..15</td><td>Numero dei pagamenti presenti nel flusso.</td></tr><tr><td>importoTotalePagamenti</td><td>1</td><td>n</td><td>1..1</td><td>1..18</td><td><p>Importo totale dei pagamenti presenti nel flusso. Deve coincidere con la somma dei dati singoloImportoPagato presenti nel flusso.</p><p><strong>Deve essere maggiore di 0.</strong></p></td></tr><tr><td>datiSingoliPagamenti</td><td>1</td><td>s</td><td>1 n</td><td> </td><td>Aggregazione con un numero di occorrenze pari all’elemento numeroTotalePagamenti</td></tr><tr><td>identificativoUnivocoVersamento</td><td>2</td><td>an</td><td>1..1</td><td>1..35</td><td>Riporta il dato codice IUV cui si riferisce il pagamento rendicontato nel flusso.</td></tr><tr><td>identificativoUnivocoRiscossione</td><td>2</td><td>an</td><td>1..1</td><td>1..35</td><td>Riferimento univoco dell’operazione, è rappresentato dal <em>payment token</em>.</td></tr><tr><td>indiceDatiSingoloPagamento</td><td>2</td><td>n</td><td>0..1</td><td>1</td><td>Indice dell’occorrenza del pagamento all’interno della struttura <em>transfer,</em> campo <em>idTransfer</em>.</td></tr><tr><td>singoloImportoPagato</td><td>2</td><td>an</td><td>1..1</td><td>3..12</td><td><p>Campo numerico indicante l’importo relativo alla somma pagata o revocata. Deve essere diverso da 0.</p><p>Qualora il singolo importo pagato è riferito ad un pagamento revocato (dato codiceEsitoSingoloPagamento =3) deve assumere un valore negativo.</p></td></tr><tr><td>codiceEsitoSingoloPagamento</td><td>2</td><td>n</td><td>1..1</td><td>1</td><td><p>Campo numerico indicante l’esito del pagamento. Può assumere i seguenti valori:</p><ul><li><strong>0</strong> = Pagamento eseguito</li><li><strong>3</strong> = Pagamento revocato</li><li><strong>4</strong> = Pagamento gestito in Stand In</li><li><strong>8</strong> = Pagamento eseguito senza riscontro di "Ricevuta Telematica" per il PSP e gestito in Stand In</li><li><strong>9</strong> = Pagamento eseguito senza riscontro di "Ricevuta Telematica" per il PSP</li></ul></td></tr><tr><td>dataEsitoSingoloPagamento</td><td>2</td><td>an</td><td>1..1</td><td>10</td><td>Indica la data in cui è stato disposto o revocato il pagamento, nel formato ISO 8601 [YYYY]-[MM]-[DD].</td></tr></tbody></table>

Per quanto riguarda gli EC, tali flussi omogenei di dati sono messi a loro disposizione attraverso l’infrastruttura di cui all’articolo 5, comma 2 del CAD alla quale sono tenuti a collegarsi i PSP che effettuano il riversamento, con le modalità riportate nelle SANP (Allegato B alle Linee guida).

Lo schema XML (XSD) descrittivo del contenuto dei file XML utilizzati per trasferire le informazioni del flusso di rendicontazione è fornito in formato elettronico nel repository GitHub pagopa-api ([https://github.com/pagopa/pagopa-api/blob/master/general/FlussoRiversamento\_1\_0\_4.xsd](https://github.com/pagopa/pagopa-api/blob/master/general/FlussoRiversamento\_1\_0\_4.xsd)).

Si sottolinea infine che, essendo il flusso di rendicontazione associato ad un singolo SCT di riversamento, detto flusso è ovviamente sempre correlato ad un unico codice IBAN di accredito.

La predisposizione di più di un FdR con lo stesso _identificativoFlusso_ è un evento eccezionale, che può essere motivato da errori presenti nel precedente flusso, tale operazione deve essere gestita con le modalità descritte nella sezione _"Gestione sovrascritture Flussi di Rendicontazione"_ presente nelle SANP.

## Precisazioni sulla colonna “contenuto” della **Tabella 6 - Flusso per la rendicontazione - Schema dati**

Tenuto presente che il significato dei dati richiesti per il flusso di rendicontazione è riportato nella colonna “contenuto” della Tabella 6, di seguito sono riportate alcune precisazioni utili agli EC sui dati presenti nel flusso di rendicontazione:

* **identificativoFlusso:** deve essere lo stesso riportato nel componente **\<identificativoFlusso>** della causale del SEPA Credit Transfer di Riversamento (dato “_Remittance Information_” - attributo AT-05, [operazione-di-trasferimento-fondi.md](operazione-di-trasferimento-fondi.md "mention"));
* **identificativoUnivocoRegolamento:** _Transaction Reference Number (TRN) AT-43 Originator Bank’s Reference_ del SEPA Credit Transfer di Riversamento;
* **identificativoUnivocoRiscossione:** rappresenta l’identificativo con il quale il PSP individua la singola operazione, è contenuto all'interno della _receipt_ elemento _receiptId_;
* **indiceDatiSingoloPagamento:** dato facoltativo che rappresenta la i-esima occorrenza di versamento all’interno della _receipt_ rendicontata;

## Standardizzazione del dato identificativoFlusso

Al fine di rendere omogenea la modalità di composizione del dato _identificativoFlusso_ presente nella causale standardizzata del SEPA Credit Transfer ed anche nel flusso di rendicontazione è adottata la seguente struttura:

**\<data regolamento>\<istituto mittente>”-“\<flusso>**

dove i componenti sopra indicati assumono il seguente significato:

* **\<data regolamento>** contiene le stesse informazioni dell’elemento _dataRegolamento_ del file XML;
* **\<istituto mittente>** contiene il codice di identificazione all'interno della piattaforma del PSP che predispone il flusso;&#x20;
* **"-"** dato fisso;
* **\<flusso>** stringa alfanumerica che, insieme alle informazioni sopra indicate, consente di individuare univocamente il flusso stesso. I caratteri ammessi all’interno della stringa sono: cifre da 0 a 9, lettere dell’alfabeto latino maiuscole e minuscole ed i caratteri della Tabella 7.

#### Tabella 7 - Caratteri ammessi

<table data-header-hidden><thead><tr><th width="150"></th><th width="150"></th><th width="150"></th><th></th></tr></thead><tbody><tr><td> </td><td><strong>ASCII</strong></td><td><strong>Simbolo</strong></td><td><strong>Nome</strong></td></tr><tr><td><strong>Dec</strong> | <strong>Hex</strong></td><td></td><td></td><td></td></tr><tr><td>45</td><td>2D</td><td>-</td><td>minus sign - hyphen</td></tr><tr><td>95</td><td>5F</td><td>_</td><td>underscore</td></tr></tbody></table>

Esempi:&#x20;

**2015-07-15xxxxxxxx-0000000001**

**2015-07-15xxxxxxxx-hh\_mm\_ss\_nnn**
