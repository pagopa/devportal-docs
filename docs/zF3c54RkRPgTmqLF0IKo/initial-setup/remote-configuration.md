# Remote configuration

This configuration is necessary if you want to use one of the following functions:

1. [send-a-message-remote-content.md](../function/send-a-message/send-a-message-remote-content.md "mention")
2. [add-attachments.md](../function/send-a-message/add-attachments.md "mention")

For both functions, it is in fact necessary to \*\*provide a\*\*_**REST web service**_ in compliance with the [relative OpenAPI](https://editor.swagger.io/?url=https://raw.githubusercontent.com/pagopa/io-functions-service-messages/master/openapi/index_external.yaml).

An exposed web service is characterized by a **configuration identifier**, a univocal alphanumeric code, generated by IO, which will correspond primarily to a set of endpoints and their API keys.

{% hint style="info" %} You must use the specific key [`manage`](../function/publish-a-service/manage-key.md) to manage the configurations: discover [how to retrieve it](../function/publish-a-service/manage-key.md#recupera-la-chiave-manage) {% endhint %}

You can define a configuration, retrieve it later, list the defined configurations, and modify a previously created configuration.

{% hint style="info" %} You can also define **more than one configuration**, within the [manage key ](../function/publish-a-service/manage-key.md)in use.

For example, if your Organization uses multiple Technology Partners that each expose a REST web service to serve remote features, a different configuration identifier can be defined for each one of them to be used later to [send the messages](../api-and-specifications/api-messages/submit-a-message-passing-the-user-tax-code-in-the-request-body.md) it is tasked with sending. {% endhint %}

{% hint style="success" %} To manage the configurations you must use the API described in [crus-remote-configurations.md](../api-and-specifications/api-messages/crus-remote-configurations.md "mention"). {% endhint %}

{% hint style="success" %} To specify the **reference configuration for each remote-content message** you must use, at the time of creation, the mandatory parameter [#configuration_id](../api-and-specifications/api-messages/submit-a-message-passing-the-user-tax-code-in-the-request-body.md#configuration_id "mention"). {% endhint %}

The exposed service must consist of a variable number of endpoints, depending on what you intend to remotely retrieve for your messages and the [type of agreement](https://docs.pagopa.it/kb-enti-accordi/domande-frequenti/domande-e-risposte-sugli-accordi#quali-sono-le-formule-contrattuali-possibili-per-aderire-allapp-io) you have signed with PagoPA:

<table><thead><tr><th>Endpoint retrieval of:</th><th width="275">Data to return to IO</th><th>Details</th></tr></thead><tbody><tr><td>opening preconditions</td><td>subject and body of preconditions</td><td></td></tr><tr><td>message details</td><td><ul><li>message subject and body;</li><li>attachment metadata (Premium entities only).</li></ul></td><td>the message details must match the intent flags declared when the message is created</td></tr><tr><td>attachment bytes</td><td>bytes of the individual attachment (Premium entities only)</td><td></td></tr></tbody></table>

{% hint style="info" %}For details about how to design the endpoints and the relative API shown, refer to [openapi-recovery-endpoint-of-remote-content.md](../api-and-specifications/openapi-recovery-endpoint-of-remote-content.md "mention").{% endhint %}

Once ready, use the API described in [crus-remote-configurations.md](../api-and-specifications/api-messages/crus-remote-configurations.md) to register the necessary data with the IO systems, including:

* the **base URL** that IO will use to dial the addresses of the endpoints exposed by your Organization (for more information refer to the examples given in [openapi-endpoint-of-recovery-of-remote-contents.md)](../api-and-specifications/openapi-recovery-endpoint-of-remote-content.md "mention")
* the** API key** that IO will use to authenticate to your systems and its expected header
* the default preference, if any, related to preconditions to opening messages (for more information on preconditions refer to [send-a-message-remote-content.md](../function/send-a-message/send-a-message-remote-content.md "mention"))

{% hint style="warning" %} In order to ensure consistency and proper in-app operation of remote-content messages over time **it is not possible to delete a configuration** once defined.

In addition, for the same reason, it is the sender's responsibility **to promptly adjust the configurations** whenever necessary, using the management API described in [crus-remote-configurations.md](../api-and-specifications/api-messages/crus-remote-configurations.md). {% endhint %}